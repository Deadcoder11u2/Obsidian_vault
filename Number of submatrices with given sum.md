Basically what you have to do is use prefix sum technique in matrix to calculate the prefix sum of any submatrix in o(1)

For further optimization fix the any two rows and apply the 1d array technique to calculate the rest of counts